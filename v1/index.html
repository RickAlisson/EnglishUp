<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnglishUp - Aprenda Ingl√™s</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Fontes: Poppins para o corpo e Raleway para os t√≠tulos -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Raleway:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Poppins para o corpo do texto */
        body { font-family: 'Poppins', sans-serif; }
        /* Raleway para os t√≠tulos */
        h1, h2, h3, h4, h5, h6 { font-family: 'Raleway', sans-serif; }
        .main-bg { background-color: #F8F9FA; }
        .primary-blue { background-color: #4A6DFF; }
        .primary-blue-text { color: #4A6DFF; }
        .secondary-gray { background-color: #E9ECEF; }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        /* Styles for custom message box */
        .message-modal {
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
        }
        .message-modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 400px;
            width: 90%;
            text-align: center;
            position: relative;
        }
        .message-modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: #6B7280;
            cursor: pointer;
            border: none;
            background: none;
        }
        /* Styles for the account menu overlay */
        .account-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 40;
            display: flex;
            justify-content: flex-end; /* Align to the right for a slide-in effect */
        }
        .account-menu-content {
            background-color: white;
            width: 80%; /* Adjust width for menu */
            max-width: 300px; /* Max width for menu */
            height: 100%;
            padding: 2rem;
            box-shadow: -4px 0 10px rgba(0,0,0,0.2);
            position: relative;
            transform: translateX(100%); /* Start off-screen */
            transition: transform 0.3s ease-out; /* Smooth slide-in */
        }
        .account-menu-content.open {
            transform: translateX(0); /* Slide in */
        }
        html {
            scroll-behavior: smooth; /* Para rolagem suave */
        }
        /* Estilos para a barra de progresso XP */
        .progress-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 9999px; /* Tailwind's rounded-full */
            height: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        .progress-bar {
            height: 100%;
            background-color: #4A6DFF; /* primary-blue */
            width: 0%;
            border-radius: 9999px; /* Tailwind's rounded-full */
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="main-bg">

    <!-- Cabe√ßalho -->
    <header class="container mx-auto px-6 py-4 flex justify-between items-center">
        <h1 class="text-3xl font-bold primary-blue-text">EnglishUp</h1>
        
        <!-- Bot√£o de menu da conta (sempre vis√≠vel) -->
        <div id="user-menu-container">
            <button id="account-menu-toggle-btn" class="text-gray-700 p-2 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-400">
                <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
        </div>
    </header>

    <!-- Overlay do Menu da Conta (Inicialmente oculto) -->
    <div id="account-menu-overlay" class="hidden account-menu-overlay">
        <div id="account-menu-content" class="account-menu-content">
            <button id="close-account-menu" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            <h3 class="text-xl font-bold mb-6 text-center primary-blue-text">Conta</h3>
            
            <!-- Conte√∫do do menu para USU√ÅRIOS LOGADOS -->
            <div id="logged-in-menu-options" class="hidden">
                <p id="user-name-menu" class="font-semibold text-gray-700 text-center mb-6"></p>
                <!-- Barra de Progresso XP -->
                <div class="mb-4 text-center">
                    <p class="text-sm text-gray-600">N√≠vel <span id="user-level-menu">1</span></p>
                    <div class="progress-bar-container">
                        <div id="xp-progress-bar" class="progress-bar"></div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1"><span id="current-xp-menu">0</span>/<span id="next-level-xp-menu">100</span> XP</p>
                </div>

                <ul class="mt-8 space-y-4 text-lg">
                    <li><a href="meu-perfil.html" class="block text-gray-700 hover:text-blue-500 p-2 rounded-lg">Meu Perfil</a></li>
                    <li><a href="licoes.html" class="block text-gray-700 hover:text-blue-500 p-2 rounded-lg">Minhas Li√ß√µes</a></li>
                </ul>
                <button id="logout-btn-menu" class="w-full text-red-500 border border-red-500 px-6 py-2 rounded-lg hover:bg-red-500 hover:text-white transition mt-8">Sair</button>
            </div>

            <!-- Conte√∫do do menu para USU√ÅRIOS N√ÉO LOGADOS -->
            <div id="logged-out-menu-options" class="hidden">
                <p class="text-gray-700 text-center mb-6">Bem-vindo(a)!</p>
                <button id="menu-login-btn" class="w-full bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition mb-4">Entrar</button>
                <button id="menu-register-btn" class="w-full text-blue-500 border border-blue-500 px-6 py-2 rounded-lg hover:bg-blue-500 hover:text-white transition">Cadastrar-se</button>
            </div>
        </div>
    </div>

    <!-- Conte√∫do da Homepage para Usu√°rios N√ÉO LOGADOS -->
    <div id="logged-out-home-content">
        <!-- Se√ß√£o Principal (Hero Section) -->
        <main class="container mx-auto px-6 py-16 flex flex-col md:flex-row items-center">
            <div class="md:w-1/2 text-center md:text-left">
                <h1 class="text-5xl md:text-6xl font-bold text-gray-800 mb-4 leading-tight">Vem ser Up!</h1>
                <p class="text-lg text-gray-600 mb-8">Aqui, voc√™ aprende a se comunicar em ingl√™s nos mais diversos ambientes, com confian√ßa e flu√™ncia.</p>
                <div class="flex justify-center md:justify-start space-x-4">
                    <!-- Bot√£o 'Come√ßar Agora' agora abre o modal de registro -->
                    <button id="start-now-btn" class="primary-blue text-white px-8 py-3 rounded-lg font-semibold hover:opacity-90 transition shadow-lg">Come√ßar Agora</button>
                    <a href="#about-us-section" id="discover-more-btn" class="secondary-gray text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition shadow-lg">Conhe√ßa mais</a>
                </div>
            </div>
            <div class="md:w-1/2 mt-12 md:mt-0">
                <!-- [Image of Pessoa estudando em um ambiente moderno] -->
                <img src="https://images.unsplash.com/photo-1516321497487-e288fb19713f?q=80&w=2070&auto=format&fit=crop"
                     alt="Pessoa estudando em um ambiente moderno"
                     class="rounded-lg shadow-2xl"
                     onerror="this.onerror=null; this.src='https://placehold.co/600x400/4A6DFF/ffffff?text=Aprenda+Ingl√™s';">
            </div>
        </main>

        <!-- Se√ß√£o Sobre N√≥s -->
        <section id="about-us-section" class="container mx-auto px-6 py-16">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Sobre o EnglishUp</h2>
            <div class="flex flex-col items-center">
                <div class="md:w-3/4 text-center">
                    <p class="text-lg text-gray-700 mb-4">
                        No EnglishUp, redefinimos o aprendizado de ingl√™s, tornando-o acess√≠vel, din√¢mico e, acima de tudo, eficaz. Nossa plataforma √© meticulosamente elaborada para gui√°-lo desde os primeiros passos at√© a flu√™ncia avan√ßada, atrav√©s de li√ß√µes interativas e conte√∫do que espelha situa√ß√µes reais do dia a dia.
                    </p>
                    <p class="text-lg text-gray-700">
                        Nosso m√©todo inovador se concentra na comunica√ß√£o pr√°tica. Preparamos voc√™ para n√£o apenas entender, mas para falar ingl√™s com confian√ßa em qualquer cen√°rio ‚Äì seja em viagens, no ambiente de trabalho ou em conversas informais. Milhares de alunos j√° est√£o transformando suas habilidades e vidas com o EnglishUp. Junte-se a n√≥s e comece a sua jornada para a flu√™ncia!
                    </p>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o Por Que Escolher o EnglishUp? -->
        <section class="container mx-auto px-6 py-16 bg-white rounded-lg shadow-lg">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Por que escolher o EnglishUp?</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center p-6 rounded-lg secondary-gray shadow-md">
                    <div class="text-primary-blue-text text-5xl mb-4">üí°</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Li√ß√µes Interativas</h3>
                    <p class="text-gray-600">Aprenda com atividades din√¢micas, v√≠deos, √°udios e exerc√≠cios pr√°ticos que tornam o aprendizado envolvente e memor√°vel.</p>
                </div>
                <div class="text-center p-6 rounded-lg secondary-gray shadow-md">
                    <div class="text-primary-blue-text text-5xl mb-4">üéØ</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Aprendizado Personalizado</h3>
                    <p class="text-gray-600">Nossas trilhas de aprendizado se adaptam ao seu n√≠vel, ritmo e objetivos, garantindo um progresso cont√≠nuo e focado.</p>
                </div>
                <div class="text-center p-6 rounded-lg secondary-gray shadow-md">
                    <div class="text-primary-blue-text text-5xl mb-4">üó£Ô∏è</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Foco na Conversa√ß√£o</h3>
                    <p class="text-gray-600">Desenvolva sua confian√ßa para se comunicar em situa√ß√µes reais atrav√©s de simula√ß√µes de di√°logo e pr√°tica oral intensiva.</p>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o Nossos Recursos Exclusivos -->
        <section class="container mx-auto px-6 py-16">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Nossos Recursos Exclusivos</h2>
            <div class="flex flex-col items-center">
                <div class="md:w-3/4 text-center">
                    <h3 class="text-3xl font-semibold text-gray-800 mb-4">Aulas ao Vivo com Professores Nativos</h3>
                    <p class="text-lg text-gray-700 mb-4">Participe de sess√µes interativas e imersivas conduzidas por professores de ingl√™s nativos. Aprimore sua pron√∫ncia, entona√ß√£o e flu√™ncia, tirando suas d√∫vidas em tempo real e praticando a conversa√ß√£o em um ambiente de apoio e est√≠mulo.</p>
                    <h3 class="text-3xl font-semibold text-gray-800 mb-4 mt-8">Comunidade Global de Alunos</h3>
                    <p class="text-lg text-gray-700">Conecte-se com uma rede vibrante de estudantes de ingl√™s de todos os cantos do mundo. Participe de f√≥runs de discuss√£o, grupos de estudo colaborativos e eventos sociais virtuais para praticar o idioma, trocar experi√™ncias e construir novas amizades, ampliando horizontes culturais e profissionais.</p>
                </div>
            </div>
        </section>

        <!-- Nova Se√ß√£o: Nossa Metodologia -->
        <section class="container mx-auto px-6 py-16 bg-white rounded-lg shadow-lg">
            <h2 class="text-4xl font-bold text-center text-gray-800 mb-12">Nossa Metodologia</h2>
            <div class="flex flex-col items-center">
                <div class="md:w-3/4 text-center">
                    <p class="text-lg text-gray-700 mb-4">
                        Nossa metodologia √© baseada em princ√≠pios pedag√≥gicos modernos, focada na imers√£o e na pr√°tica constante. Dividimos o aprendizado em m√≥dulos tem√°ticos e aulas curtas, que se encaixam perfeitamente na sua rotina. Utilizamos a repeti√ß√£o espa√ßada e exerc√≠cios contextualizados para garantir que o conhecimento seja absorvido de forma duradoura.
                    </p>
                    <p class="text-lg text-gray-700">
                        Priorizamos a aplica√ß√£o do ingl√™s em cen√°rios reais, desde a compreens√£o auditiva at√© a produ√ß√£o oral e escrita. Com um acompanhamento inteligente do seu progresso, adaptamos os desafios para que voc√™ esteja sempre motivado e evoluindo, transformando o "eu n√£o consigo" em "eu consigo".
                    </p>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o Chamada para A√ß√£o -->
        <section class="container mx-auto px-6 py-16 text-center">
            <h2 class="text-4xl font-bold text-gray-800 mb-8">Pronto para come√ßar a falar ingl√™s com confian√ßa?</h2>
            <p class="text-xl text-gray-600 mb-12">Sua jornada para a flu√™ncia come√ßa aqui. Cadastre-se gratuitamente e descubra um novo mundo de possibilidades.</p>
            <!-- Bot√£o 'Quero Aprender Ingl√™s!' agora tamb√©m abre o modal de registro -->
            <button id="learn-english-btn" class="primary-blue text-white px-10 py-4 rounded-lg font-semibold text-xl hover:opacity-90 transition shadow-lg">Quero Aprender Ingl√™s!</button>
        </section>
    </div>

    <!-- Conte√∫do da Homepage para Usu√°rios LOGADOS -->
    <div id="logged-in-home-content" class="hidden">
        <main class="container mx-auto px-6 py-24 text-center">
            <h1 id="welcome-message" class="text-5xl md:text-6xl font-bold text-gray-800 mb-8 leading-tight"></h1>
            <p class="text-lg text-gray-600 mb-16">Explore novas li√ß√µes e aprimore suas habilidades em ingl√™s.</p>
            
            <section class="my-16">
                <h2 class="text-4xl font-bold text-gray-800 mb-10">Li√ß√µes em Destaque para Voc√™</h2>
                <div id="featured-lessons-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Li√ß√µes ser√£o inseridas aqui pelo JS -->
                </div>
                <a href="licoes.html" class="primary-blue text-white px-8 py-3 rounded-lg font-semibold hover:opacity-90 transition shadow-lg mt-12 inline-block">Ver Todas as Li√ß√µes</a>
            </section>

            <section class="my-16">
                <h2 class="text-4xl font-bold text-gray-800 mb-10">Artigos e Dicas de Ingl√™s</h2>
                <div id="articles-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Artigos ser√£o inseridos aqui pelo JS -->
                </div>
                <a href="#" class="secondary-gray text-gray-700 px-8 py-3 rounded-lg font-semibold hover:bg-gray-300 transition shadow-lg mt-12 inline-block">Ver Todos os Artigos</a>
            </section>
        </main>
    </div>

    <!-- Rodap√© -->
    <footer class="bg-gray-800 text-white py-8 mt-16">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2024 EnglishUp. Todos os direitos reservados.</p>
            <p class="text-sm mt-2">Feito com ‚ù§Ô∏è para voc√™ aprender ingl√™s de verdade!</p>
        </div>
    </footer>

    <!-- Modal de Registro -->
    <div id="register-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl p-8 w-full max-w-md relative">
            <h2 class="text-2xl font-bold mb-6 text-center">Criar Conta</h2>
            <form id="register-form">
                <div class="mb-4">
                    <label for="reg-name">Nome</label>
                    <input type="text" id="reg-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                </div>
                <div class="mb-4">
                    <label for="reg-email">Email</label>
                    <input type="email" id="reg-email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                </div>
                <div class="mb-6">
                    <label for="reg-password">Senha</label>
                    <input type="password" id="reg-password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                </div>
                <button type="submit" class="w-full primary-blue text-white py-2 rounded-lg font-semibold hover:opacity-90">Cadastrar</button>
            </form>
            <button id="close-register-modal" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>
    </div>

    <!-- Modal de Login -->
    <div id="login-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl p-8 w-full max-w-md relative">
             <h2 class="text-2xl font-bold mb-6 text-center">Entrar</h2>
            <form id="login-form">
                <div class="mb-4">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                </div>
                <div class="mb-6">
                    <label for="login-password">Senha</label>
                    <input type="password" id="login-password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                </div>
                <button type="submit" class="w-full primary-blue text-white py-2 rounded-lg font-semibold hover:opacity-90">Entrar</button>
            </form>
             <button id="close-login-modal" class="absolute top-4 right-4 text-2xl text-gray-500 hover:text-gray-800">&times;</button>
        </div>
    </div>

    <!-- Modal de Mensagem -->
    <div id="message-modal" class="hidden message-modal">
        <div class="message-modal-content">
            <button id="close-message-modal" class="message-modal-close-btn">&times;</button>
            <p id="message-text" class="text-lg text-gray-800"></p>
            <button id="message-ok-btn" class="primary-blue text-white px-6 py-2 rounded-lg font-semibold mt-6 hover:opacity-90">OK</button>
        </div>
    </div>
    
    <script>
    // --- Fun√ß√µes de Ajuda e Gerenciamento de Dados do Usu√°rio (Centralizadas para Reuso) ---
    // Definindo a quantidade de XP por li√ß√£o e os pontos de XP para cada n√≠vel
    const XP_PER_LESSON = 50;
    const XP_LEVELS = [
        0,   // N√≠vel 1 come√ßa com 0 XP
        100, // N√≠vel 2 precisa de 100 XP
        250, // N√≠vel 3 precisa de 250 XP
        500, // N√≠vel 4 precisa de 500 XP
        900, // N√≠vel 5 precisa de 900 XP
        1500, // N√≠vel 6 precisa de 1500 XP
        2500, // N√≠vel 7 precisa de 2500 XP
        3800, // N√≠vel 8 precisa de 3800 XP
        5000, // N√≠vel 9 precisa de 5000 XP
        6500, // N√≠vel 10 precisa de 6500 XP
        8000  // Exemplo: N√≠vel 11 precisa de 8000 XP (adicione mais conforme necess√°rio)
    ];

    /**
     * Obt√©m os dados do usu√°rio logado do localStorage.
     * Inicializa XP, n√≠vel e li√ß√µes conclu√≠das para XP se n√£o existirem.
     * @returns {object|null} Dados do usu√°rio ou null se n√£o houver usu√°rio logado.
     */
    function getUserData() {
        const loggedInUser = localStorage.getItem('loggedInUser');
        if (!loggedInUser) return null;

        let users = JSON.parse(localStorage.getItem('users')) || [];
        let userData = users.find(user => user.name === loggedInUser);

        // Inicializa XP, n√≠vel e li√ß√µes conclu√≠das se n√£o existirem
        if (!userData.xp) userData.xp = 0;
        if (!userData.level) userData.level = 1;
        // Usaremos 'completedLessons' de forma unificada agora, n√£o 'completedLessonsXP'
        if (!userData.completedLessons) userData.completedLessons = {}; // { 'secao1-aula1': true, ... }

        return userData;
    }

    /**
     * Salva os dados atualizados do usu√°rio no localStorage.
     * @param {object} userData O objeto de dados do usu√°rio a ser salvo.
     */
    function saveUserData(userData) {
        let users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(user => user.name === localStorage.getItem('loggedInUser'));
        if (userIndex !== -1) {
            users[userIndex] = userData;
            localStorage.setItem('users', JSON.stringify(users));
        }
    }

    /**
     * Calcula o n√≠vel atual do usu√°rio e o progresso da barra de XP.
     * @param {number} xp O XP total do usu√°rio.
     * @returns {object} Objeto contendo n√≠vel, XP para o n√≠vel atual/pr√≥ximo e porcentagem de progresso.
     */
    function calculateLevelAndProgress(xp) {
        let level = 1;
        let xpForCurrentLevel = 0;
        let xpForNextLevel = XP_LEVELS[1] || Infinity; // XP necess√°rio para o pr√≥ximo n√≠vel

        for (let i = 0; i < XP_LEVELS.length; i++) {
            if (xp >= XP_LEVELS[i]) {
                level = i + 1; // O n√≠vel √© o √≠ndice + 1
                xpForCurrentLevel = XP_LEVELS[i];
                xpForNextLevel = XP_LEVELS[i + 1] || Infinity; // Define o XP para o pr√≥ximo n√≠vel ou infinito se for o √∫ltimo
            } else {
                break; // Sai do loop se o XP for menor que o requisito do n√≠vel atual
            }
        }
        
        const xpGainedInLevel = xp - xpForCurrentLevel; // XP ganho dentro do n√≠vel atual
        // XP necess√°rio para o pr√≥ximo n√≠vel a partir do in√≠cio do n√≠vel atual
        const xpNeededForNextLevel = (xpForNextLevel === Infinity) ? Infinity : (xpForNextLevel - xpForCurrentLevel);
        const progressPercentage = (xpNeededForNextLevel > 0 && xpNeededForNextLevel !== Infinity) ? (xpGainedInLevel / xpNeededForNextLevel) * 100 : 100;

        return {
            level: level,
            xpForCurrentLevel: xpForCurrentLevel,
            xpForNextLevel: xpForNextLevel,
            xpGainedInLevel: xpGainedInLevel,
            xpNeededForNextLevelDisplay: (xpForNextLevel === Infinity) ? 'MAX' : xpNeededForNextLevel, // Para exibi√ß√£o
            progressPercentage: progressPercentage
        };
    }

    /**
     * Atualiza a barra de progresso de XP e o n√≠vel no menu lateral.
     */
    function updateProgressBarInMenu() {
        const userData = getUserData();
        if (!userData) {
            console.log("Usu√°rio n√£o logado, n√£o √© poss√≠vel atualizar a barra de progresso.");
            return;
        }

        const { level, xpGainedInLevel, xpNeededForNextLevelDisplay, progressPercentage } = calculateLevelAndProgress(userData.xp);

        const userLevelMenuEl = document.getElementById('user-level-menu');
        const xpProgressBarEl = document.getElementById('xp-progress-bar');
        const currentXpMenuEl = document.getElementById('current-xp-menu');
        const nextLevelXpMenuEl = document.getElementById('next-level-xp-menu');

        if (userLevelMenuEl) userLevelMenuEl.textContent = level;
        if (xpProgressBarEl) xpProgressBarEl.style.width = `${progressPercentage}%`;
        if (currentXpMenuEl) currentXpMenuEl.textContent = xpGainedInLevel;
        if (nextLevelXpMenuEl) nextLevelXpMenuEl.textContent = xpNeededForNextLevelDisplay;
    }
    // --- Fim das Fun√ß√µes de Ajuda ---

    document.addEventListener('DOMContentLoaded', () => {
        // Obter elementos para os conte√∫dos da homepage (logado/deslogado)
        const loggedOutHomeContent = document.getElementById('logged-out-home-content');
        const loggedInHomeContent = document.getElementById('logged-in-home-content');
        const welcomeMessage = document.getElementById('welcome-message');
        const featuredLessonsGrid = document.getElementById('featured-lessons-grid');
        const articlesGrid = document.getElementById('articles-grid');

        // Obter elementos para os modais de login/cadastro
        const registerModal = document.getElementById('register-modal');
        const loginModal = document.getElementById('login-modal');
        const closeRegisterModalBtn = document.getElementById('close-register-modal');
        const closeLoginModalBtn = document.getElementById('close-login-modal');

        // Obter elementos para os formul√°rios
        const registerForm = document.getElementById('register-form');
        const loginForm = document.getElementById('login-form');

        // Obter elementos para o modal de mensagem personalizado
        const messageModal = document.getElementById('message-modal');
        const messageTextEl = document.getElementById('message-text');
        const closeMessageModalBtn = document.getElementById('close-message-modal');
        const messageOkBtn = document.getElementById('message-ok-btn');

        // Obter o bot√£o "Conhe√ßa mais" e a se√ß√£o alvo
        const discoverMoreBtn = document.getElementById('discover-more-btn');
        const aboutUsSection = document.getElementById('about-us-section');

        // Elementos do menu de conta (universal agora)
        const accountMenuToggleBtn = document.getElementById('account-menu-toggle-btn');
        const accountMenuOverlay = document.getElementById('account-menu-overlay');
        const accountMenuContent = document.getElementById('account-menu-content');
        const closeAccountMenuBtn = document.getElementById('close-account-menu');
        const userNameMenuEl = document.getElementById('user-name-menu');
        const logoutBtnMenu = document.getElementById('logout-btn-menu');
        const loggedInMenuOptions = document.getElementById('logged-in-menu-options');
        const loggedOutMenuOptions = document.getElementById('logged-out-menu-options');
        const menuLoginBtn = document.getElementById('menu-login-btn');
        const menuRegisterBtn = document.getElementById('menu-register-btn');


        // Bot√µes que levam ao modal de registro (para usu√°rios deslogados)
        const startNowBtn = document.getElementById('start-now-btn');
        const learnEnglishBtn = document.getElementById('learn-english-btn');

        // Dados para aulas e artigos (simulados)
        const allLessons = [
            { title: "Aula 1: Fazendo seu Pedido", section: "Restaurante", url: "secao1-aula1.html", desc: "Vocabul√°rio essencial para pedir comida e bebida." },
            { title: "Aula 2: Interagindo com o Gar√ßom", section: "Restaurante", url: "secao1.html", desc: "Como se comunicar com a equipe do restaurante." },
            { title: "Aula 1: No Supermercado", section: "Compras", url: "secao2-aula1.html", desc: "Vocabul√°rio de produtos e como perguntar pre√ßos." },
            { title: "Aula 2: Roupas e Acess√≥rios", section: "Compras", url: "secao2.html", desc: "Termos para tamanhos, cores e como provar roupas." },
            { title: "Aula 3: Pagamento e Caixas", section: "Compras", url: "secao2.html", desc: "Frases para pagar, pedir nota fiscal e troco." },
            { title: "Aula 1: Chegada e Check-in", section: "Aeroporto", url: "secao3.html", desc: "Frases para check-in e seguran√ßa." },
            { title: "Aula 2: Embarque e Voo", section: "Aeroporto", url: "secao3.html", desc: "Comunica√ß√£o no port√£o de embarque e durante o voo." },
            { title: "Aula 1: Primeiros Encontros", section: "Vida Social", url: "#", desc: "Frases para se apresentar e iniciar uma conversa." },
        ];

        const allArticles = [
            { title: "5 Dicas Essenciais para Melhorar sua Pron√∫ncia", snippet: "Descubra como pequenos ajustes podem fazer uma grande diferen√ßa na sua clareza ao falar ingl√™s.", url: "#" },
            { title: "Guia Completo de Phrasal Verbs", snippet: "Desmistifique os phrasal verbs mais comuns e como us√°-los no dia a dia.", url: "#" },
            { title: "Como Manter a Motiva√ß√£o no Aprendizado de Ingl√™s", snippet: "Estrat√©gias eficazes para manter o foco e o √¢nimo durante sua jornada de aprendizado.", url: "#" },
            { title: "Erros Comuns de Iniciantes em Ingl√™s", snippet: "Evite as armadilhas mais comuns ao come√ßar a aprender ingl√™s.", url: "#" },
            { title: "Benef√≠cios de Aprender Ingl√™s para a Carreira", snippet: "Descubra como a flu√™ncia em ingl√™s pode impulsionar sua vida profissional.", url: "#" },
        ];

        /**
         * Embaralha um array no lugar (algoritmo de Fisher-Yates).
         * @param {Array} array O array a ser embaralhado.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Troca elementos
            }
        }

        /**
         * Renderiza uma sele√ß√£o de li√ß√µes em destaque.
         * @param {number} count O n√∫mero de li√ß√µes a serem exibidas.
         */
        function renderFeaturedLessons(count) {
            featuredLessonsGrid.innerHTML = '';
            const shuffledLessons = [...allLessons]; // Cria uma c√≥pia para embaralhar
            shuffleArray(shuffledLessons);

            for (let i = 0; i < Math.min(count, shuffledLessons.length); i++) {
                const lesson = shuffledLessons[i];
                const lessonCard = `
                    <a href="${lesson.url}" class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 block">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">${lesson.title} (${lesson.section})</h3>
                        <p class="text-gray-600">${lesson.desc}</p>
                    </a>
                `;
                featuredLessonsGrid.insertAdjacentHTML('beforeend', lessonCard);
            }
        }

        /**
         * Renderiza uma sele√ß√£o de artigos.
         * @param {number} count O n√∫mero de artigos a serem exibidos.
         */
        function renderArticles(count) {
            articlesGrid.innerHTML = '';
            const shuffledArticles = [...allArticles]; // Cria uma c√≥pia para embaralhar
            shuffleArray(shuffledArticles);

            for (let i = 0; i < Math.min(count, shuffledArticles.length); i++) {
                const article = shuffledArticles[i];
                const articleCard = `
                    <a href="${article.url}" class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 block">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">${article.title}</h3>
                        <p class="text-gray-600 text-sm">${article.snippet}</p>
                    </a>
                `;
                articlesGrid.insertAdjacentHTML('beforeend', articleCard);
            }
        }


        // Fun√ß√£o para exibir mensagens personalizadas no modal
        function showMessage(message) {
            messageTextEl.textContent = message;
            messageModal.classList.remove('hidden');
        }

        // Fun√ß√£o para ocultar mensagens personalizadas do modal
        function hideMessage() {
            messageModal.classList.add('hidden');
        }

        // Listeners de eventos para o modal de mensagem
        closeMessageModalBtn.addEventListener('click', hideMessage);
        messageOkBtn.addEventListener('click', hideMessage);
        messageModal.addEventListener('click', (e) => {
            if (e.target === messageModal) {
                hideMessage();
            }
        });


        // Fun√ß√£o para verificar e atualizar o estado de login na interface
        function checkLoginState() {
            const loggedInUser = localStorage.getItem('loggedInUser'); // Obter usu√°rio logado do armazenamento local
            if (loggedInUser) {
                // Usu√°rio LOGADO
                loggedOutHomeContent.classList.add('hidden'); // Ocultar conte√∫do deslogado
                loggedInHomeContent.classList.remove('hidden'); // Mostrar conte√∫do logado
                
                // Configurar menu lateral para LOGADO
                loggedInMenuOptions.classList.remove('hidden');
                loggedOutMenuOptions.classList.add('hidden');
                userNameMenuEl.textContent = `Ol√°, ${loggedInUser}!`; // Atualiza o nome no menu lateral
                updateProgressBarInMenu(); // Atualiza a barra de progresso no menu

                welcomeMessage.textContent = `Bem-vindo de volta, ${loggedInUser}!`; // Personalizar mensagem de boas-vindas
                renderFeaturedLessons(3); // Renderizar 3 aulas em destaque
                renderArticles(2); // Renderizar 2 artigos

            } else {
                // Usu√°rio N√ÉO LOGADO
                loggedOutHomeContent.classList.remove('hidden'); // Mostrar conte√∫do deslogado
                loggedInHomeContent.classList.add('hidden'); // Ocultar conte√∫do logado

                // Configurar menu lateral para N√ÉO LOGADO
                loggedInMenuOptions.classList.add('hidden');
                loggedOutMenuOptions.classList.remove('hidden');
            }
        }
        
        // L√≥gica dos modais de login/cadastro: abrir/fechar
        closeRegisterModalBtn.addEventListener('click', () => registerModal.classList.add('hidden'));
        closeLoginModalBtn.addEventListener('click', () => loginModal.classList.add('hidden'));

        // Lidar com cliques fora do conte√∫do do modal para fech√°-los
        registerModal.addEventListener('click', (e) => {
            if (e.target === registerModal) {
                registerModal.classList.add('hidden');
            }
        });

        loginModal.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.classList.add('hidden');
            }
        });

        // L√≥gica de registro
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault(); // Prevenir envio padr√£o do formul√°rio
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            
            // Recuperar usu√°rios existentes do armazenamento local ou inicializar um array vazio
            let users = JSON.parse(localStorage.getItem('users')) || [];
            
            // Verificar se o email j√° existe
            if (users.find(user => user.email === email)) {
                showMessage('Este email j√° est√° cadastrado.');
                return; // Parar a execu√ß√£o se o email existir
            }
            
            // Adicionar novo usu√°rio ao array
            // Inicializa xp e completedLessons para o novo usu√°rio
            users.push({ name, email, password, xp: 0, completedLessons: {} }); 
            // Salvar o array de usu√°rios atualizado no armazenamento local
            localStorage.setItem('users', JSON.stringify(users));
            
            showMessage('Cadastro realizado com sucesso! Fa√ßa o login.');
            registerModal.classList.add('hidden'); // Ocultar modal de registro
            loginModal.classList.remove('hidden'); // Mostrar modal de login
        });

        // L√≥gica de login
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault(); // Prevenir envio padr√£o do formul√°rio
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            // Recuperar usu√°rios registrados do armazenamento local
            let users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                localStorage.setItem('loggedInUser', user.name); // Armazenar o nome do usu√°rio logado
                loginModal.classList.add('hidden'); // Ocultar modal de login
                checkLoginState(); // Atualizar interface (para mostrar conte√∫do logado)
            } else {
                showMessage('Email ou senha inv√°lidos.'); // Mostrar mensagem de erro
            }
        });

        // L√≥gica de logout para o menu lateral
        function performLogout() {
            localStorage.removeItem('loggedInUser'); // Remover usu√°rio logado do armazenamento local
            checkLoginState(); // Atualizar interface (para mostrar conte√∫do deslogado)
            showMessage('Voc√™ foi desconectado.');
        }
        logoutBtnMenu.addEventListener('click', performLogout);


        // L√≥gica do menu de conta (universal)
        accountMenuToggleBtn.addEventListener('click', () => {
            accountMenuOverlay.classList.remove('hidden');
            setTimeout(() => {
                accountMenuContent.classList.add('open');
                // Decide qual conte√∫do do menu mostrar
                const loggedInUser = localStorage.getItem('loggedInUser');
                if (loggedInUser) {
                    if (loggedInMenuOptions) loggedInMenuOptions.classList.remove('hidden');
                    if (loggedOutMenuOptions) loggedOutMenuOptions.classList.add('hidden');
                    if (userNameMenuEl) userNameMenuEl.textContent = `Ol√°, ${loggedInUser}!`;
                    updateProgressBarInMenu(); // Atualiza a barra de progresso ao abrir o menu
                } else {
                    if (loggedInMenuOptions) loggedInMenuOptions.classList.add('hidden');
                    if (loggedOutMenuOptions) loggedOutMenuOptions.classList.remove('hidden');
                    console.log('Usu√°rio n√£o logado, mostrando op√ß√µes de login/cadastro no menu.');
                }
            }, 10); // Pequeno atraso para a transi√ß√£o
        });

        closeAccountMenuBtn.addEventListener('click', () => {
            accountMenuContent.classList.remove('open');
            setTimeout(() => {
                accountMenuOverlay.classList.add('hidden');
            }, 300); // Combinar com a dura√ß√£o da transi√ß√£o
        });

        accountMenuOverlay.addEventListener('click', (e) => {
            if (e.target === accountMenuOverlay) {
                accountMenuContent.classList.remove('open');
                setTimeout(() => {
                    accountMenuOverlay.classList.add('hidden');
                }, 300);
            }
        });

        // Listeners para bot√µes de login/registro DENTRO do menu
        if(menuLoginBtn) menuLoginBtn.addEventListener('click', () => {
            accountMenuOverlay.classList.add('hidden'); // Fecha o menu lateral
            loginModal.classList.remove('hidden'); // Abre o modal de login
        });
        if(menuRegisterBtn) menuRegisterBtn.addEventListener('click', () => {
            accountMenuOverlay.classList.add('hidden'); // Fecha o menu lateral
            registerModal.classList.remove('hidden'); // Abre o modal de registro
        });


        // Rolagem suave para o bot√£o "Conhe√ßa mais" (apenas para deslogados)
        if (discoverMoreBtn) { 
            discoverMoreBtn.addEventListener('click', (e) => {
                e.preventDefault(); 
                if (aboutUsSection) { 
                    aboutUsSection.scrollIntoView({ behavior: 'smooth' });
                }
            });
        }

        // Event listeners para os bot√µes que levam ao modal de registro (para deslogados)
        if (startNowBtn) { 
            startNowBtn.addEventListener('click', () => {
                registerModal.classList.remove('hidden');
            });
        }
        if (learnEnglishBtn) {
            learnEnglishBtn.addEventListener('click', () => {
                registerModal.classList.remove('hidden');
            });
        }


        // Verifica√ß√£o inicial do estado de login quando a p√°gina carrega
        checkLoginState();
    });
    </script>
</body>
</html>
